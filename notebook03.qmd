[TOP](https://8-u8.github.io/MathematicalStatistics/)

# 数理統計学ノート03 多次元確率分布
1変量の分布は一旦すっ飛ばした(僕が担当じゃないので)。  
多次元の確率分布について記述する。

## 同時分布と条件付き分布
$X$と$Y$を2つの確率変数とおく。この2つの確率変数の組$(X, Y)$を確率変数ベクトルと呼び、
$(X, Y)$が同時に発生する事象を考える。  
たとえば10円玉のコイントスの実現値を$X$、100円玉のコイントスの実現値を$Y$として、  
両手で同時にコイントスをする事を考えるのも良い。このとき表が出たら1、裏が出たら0と定義すれば、
確率変数は実際に$\mathbb{R}^2$(これは二次元の実数の集合を意味する)に属する要素の上で定義される。

### 同時分布と周辺分布の理論
同時分布について、まず離散確率変数を考える。  
基本的には単変量の分布を考えることと同様に考えることができる。  
「同時」の名前は、$(X,Y)$に関する具体的な値が一緒に与えられることを意味する。  
このとき、同時確率は
$$
p(x, y) = P(X = x, Y = y)
$$
で与えられるし、累積分布関数は
$$
F(x, y) = P(X \leq x, Y \leq y)
$$
で定義できる。基本は1次元確率分布と同様に定義できる。  
他の本でも基本は同様であるか[[久保川]](https://amzn.asia/d/eRgNHzehttps://amzn.asia/d/eRgNHze)、最初から一般の$d$次元確率変数の分布について定義をして、
$d=1$や$d=2$のときを特別な場合として記述しているような書籍もある[[清水]](https://8-u8.github.io/MathematicalStatistics/notebook03.html)。

$X$の周辺分布は、同時に起こりうる$Y$の値すべてを考慮したときの確率で、  
以下のように表現される。

$$
F_X(x) = P(X \leq x, Y \leq \infty)=\sum_{x \in X}^x\sum_{y \in Y}^{\infty}p(x, y)
$$

### クロス表と同時分布

もっと気楽に考えるとクロス集計表は同時分布の離散表現に近い。  
行和/列和がそれぞれ同時分布である。これがわかるとまあまあ集計時の見通しが良くなると思うし、  
クロス集計表が同時分布であるという雰囲気を感じるだけで「なんでこの表で検定ができるんだ？」  
というところにふんわりとした直感が働くようになるとも思う。

### 同時分布と周辺分布の可視化
ChatGPTに「同時分布のようなグラフを描くRのコードを描いて！」ってお願いしてみる。  
出てきた結果の一部は見にくい書き方をしていたので、ちょっと勝手に添削をしています。  

```{r}
# define density mixture function
dens_mixture <- function(x, y, mu = 0, sigma = 1) {
    out <- dnorm(x, mean = mu, sd = sigma) * dnorm(y, mean = mu, sd = sigma)
    out
}
# code below was written by ChatGPT
# Create a grid of x and y values
x <- seq(-4, 4, length.out = 100)
y <- seq(-4, 4, length.out = 100)
z <- outer(x, y, dens_mixture)

# Create the 3D plot
persp(x, y, z,
    a = 30, phi = 30, expand = 0.5,
    col = "lightblue", ltheta = 120, shade = 0.3,
    xlab = "X", ylab = "Y", zlab = "probability"
)

```

周辺分布は、例えば以下。上と右にあるのが周辺分布。  
ChatGPTに丸投げしたらあんまりいい感じにならなかったので、割と自分で書き直した。

```{r}
# Load the necessary libraries
set.seed(523)
library(ggplot2)
library(ggExtra)

# define density mixture function
dens_mixture <- function(x, y, mu = 0, sigma = 1) {
    out <- dnorm(x, mean = mu, sd = sigma) * dnorm(y, mean = mu, sd = sigma)
    out
}
# Define the normal distribution parameters
mu <- 0
sigma <- 1

# Create a dataset with x and y values
x <- rnorm(1000, mu, sigma)
y <- rnorm(1000, mu, sigma)
df <- data.frame(x = x, y = y)
# Create the 2D plot with marginal distributions
p <- ggplot2::ggplot(df) +
    ggplot2::geom_density2d(aes(x = x, y = y), geom = "line") +
    ggplot2::geom_point(aes(x = x, y = y)) +
    ggplot2::scale_fill_gradient(low = "white", high = "blue")

ggExtra::ggMarginal(p, type = "density")


```



### 条件付き分布

条件付き分布は、$(X, Y)$のうち、どちらか一方が与えられたという状態で、  
もう一方が実現する確率を表現する。つまり「同時」ではないし、  
お互いが何らかの法則を持って連動している。n



## ヤコビアンと畳み込み
多分人生で一番難しい


## 条件付き期待値
世界一難しい


## 主な分布

### 多項分布
わからん


### 多変量正規分布
やさしい

 